actions.precombat+=/mark_of_the_wild,if=!up&!buff.gift_of_the_wild.up
actions.precombat+=/thorns,if=!up
actions.precombat+=/cat_form,if=!up
actions.precombat+=/potion

actions.init+=/variable,name=can_rip,value=(active_enemies<=2&debuff.mangle.up&combo_points.current>=5&buff.savage_roar.remains>=0.5)&((!buff.clearcasting.up)|(buff.clearcasting.up&(systime-lost_rip_time)>4&cooldown.faerie_fire_feral.remains<2)|!debuff.bleed.up)
actions.init+=/variable,name=can_rake,value=debuff.rake.down&((combo_points.current=0&buff.savage_roar.down)|((active_enemies<=2)&debuff.mangle.up&(buff.savage_roar.remains>cast_window)&(!buff.clearcasting.up|!isBleeding|armor_penetration<=92|(agile_remains>0&agile_remains<=9))))
actions.init+=/variable,name=can_shred,value=settings.ferociousbite_enabled&active_enemies<=2&debuff.mangle.up&isBleeding&combo_points.current>=5&((buff.savage_roar.remains>=3&debuff.rip.remains>8)|((cooldown.tigers_fury.remains<=4)&((buff.savage_roar.remains<3&debuff.rip.remains>8)|(buff.savage_roar.remains>11&debuff.rip.remains<4)|(buff.savage_roar.remains>7&buff.savage_roar.remains<11&buff.savage_roar.remains>(debuff.rip.remains+3))))|(buff.savage_roar.remains>=3&ttd<10))
actions.init+=/variable,name=bite_now,value=(buff.berserk.remains=0&buff.clearcasting.remains=0&energy.current<(35+(timing*10)))|(buff.berserk.remains=0&buff.clearcasting.remains>0&energy.current<max(0,(timing*10)-7)|(buff.berserk.remains>0&buff.clearcasting.remains=0&energy.current<27)|(buff.berserk.remains>0&buff.clearcasting.remains>0&energy.current<10)
actions.init+=/variable,name=shred_now,value=variable.can_shred&!variable.bite_now

actions+=/call_action_list,name=init
actions+=/faerie_fire_feral,if=!combat&!buff.clearcasting.up
actions+=/faerie_fire_feral,if=combat&!buff.clearcasting.up&((combo_points.current>=5&cooldown.faerie_fire_feral.remains<cast_window&debuff.rip.remains>gcd.remains)|(combo_points.current<5&cooldown.faerie_fire_feral.remains<1))&((buff.berserk.remains=0&energy.current<=85)|(buff.berserk.remains>=cast_window&energy.current<=20))
actions+=/hyperspeed_acceleration,use_off_gcd=1,if=toggle.essences&buff.savage_roar.remains>=1
actions+=/berserk,if=toggle.cooldowns&boss&cooldown.berserk.remains<cast_window&buff.tigers_fury.remains>1&buff.savage_roar.remains>8
actions+=/ferocious_bite,if=variable.can_rip&ttd<10&energy.current<=65
actions+=/shred,if=variable.can_rip&ttd<10&energy.current>65
actions+=/rip,if=variable.can_rip
actions+=/savage_roar,if=(buff.savage_roar.remains<0.5&combo_points.current>=1)|((debuff.rip.remains>0)&(buff.savage_roar.remains>0)&(debuff.rip.remains<=(5*combo_points.current-16))&(buff.savage_roar.remains<=(debuff.rip.remains+4)))
actions+=/mangle_cat,if=!debuff.mangle.up&active_enemies<=2
actions+=/tigers_fury,use_off_gcd=1,if=cooldown.tigers_fury.remains<cast_window&energy.current<fury_energy_threshold&buff.berserk.down
actions+=/shred,if=variable.can_rake&active_enemies<=2&(ttd<6|(ttd<9&isBleeding))
actions+=/rake,if=variable.can_rake
actions+=/swipe_cat,if=active_enemies>2&(buff.savage_roar.remains>cast_window|buff.clearcasting.up)
actions+=/ferocious_bite,if=variable.can_shred&variable.bite_now
actions+=/shred,if=active_enemies<2&debuff.rip.remains>cast_window&buff.savage_roar.remains=0&combo_points.current=0
actions+=/shred,if=active_enemies<2&debuff.mangle.up&buff.savage_roar.remains>cast_window&(isBleeding|ttd<6)&(buff.clearcasting.up|(buff.berserk.remains>0&(combo_points.current<5|(combo_points.current>=5&energy.current>=27)))|(buff.berserk.remains=0&((combo_points.current>=5&energy.current>=shredEThreshold1)|(combo_points.current<5&energy.current>=shredEThreshold2)|(debuff.rip.remains>=1&(crit_chance>74|armor_penetration>92|variable.shred_now)))))
actions+=/cat_form,if=!up
